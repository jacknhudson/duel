<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
</head>

<body>

  <% include ../partials/nav.ejs %>
<div class="jumbotron text-center">
  <div id="all" class="hideme" class="container">
    <h2 id="question" index="">Question</h2>
    <h4 id="errorMsg"></h4>
    <form method="post" action="/submitResponse">
    <textarea id="response" name="response" maxlength="300" placeholder="Type Response..." onkeyup="keyhandler();" autofocus></textarea>
    <input type="hidden" id="question_id" name="question_id" value="-1">
    <input type="hidden" id="user_id" name="user_id" value="-1">
    </form>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <p class="left"><span id="charCount">0</span>/250<br><a class="feedback-link" id="feedback" href="/feedback">Feedback?</a></p>
    </div>
    <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
      <p class="right" id="directions">Press Enter to skip</p>
    </div>
  </div>
</div>
</body>
<!-- On-pageload script added in line for optimization -->
<script type="text/javascript">
  $(window).load(function(){
    $.getScript('./scripts/questions.js', function()
    {
     var randomIndex = Math.floor(Math.random() * questions.length);
      var selectedQuestion = questions[randomIndex];
      document.getElementById("question").innerHTML = selectedQuestion;
      document.getElementById("question_id").setAttribute("value",randomIndex.toString());
      $( "#all" ).fadeIn( "fast", function() {
        // Animation complete
      });
    });
    var ls = localStorage.getItem('rqt_user_id');
    var user_id = ls || '<%= rqt_user_id %>' || " "
    if (user_id.length >= 5) {
      document.getElementById("account").innerHTML = "My Account";
      document.getElementById("account").href="/account?user_id="+user_id;
      document.getElementById("feedback").style.visibility="visible";
      localStorage.setItem('rqt_user_id', user_id);
    }
  });
</script>
<script src="/scripts/questions.js"></script> 
<script src="/scripts/selectQuestion.js"></script>
</html>
